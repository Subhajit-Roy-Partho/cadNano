services:
  cadnano2:
    image: subhajitroy/cadnano:latest
    container_name: cadnano2-gui
    environment:
      - DISPLAY=${DISPLAY:-:0}
      - QT_X11_NO_MITSHM=1
      - QT_QPA_PLATFORM=xcb
    extra_hosts:
      - "host.docker.internal:host-gateway"
    volumes:
      # X11 forwarding for GUI support
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
      - ${XAUTHORITY:-~/.Xauthority}:/home/cadnano/.Xauthority:ro
      # Data persistence
      - ./cadnano_data:/home/cadnano/data:Z
      - ./cadnano_projects:/home/cadnano/projects:Z
    stdin_open: true
    tty: true
    network_mode: host
    command: /home/cadnano/start_cadnano.sh

volumes:
  cadnano_data:
    driver: local